#!/usr/bin/bash

__browsers="chrome chromium brave vivaldi opera"

for __browser in $__browsers; do
    if pgrep -x "$__browser" >/dev/null 2>&1; then
        printf "Sending SIGTERM to %s...\n" "$__browser"
        pkill -15 -x "$__browser" 2>/dev/null || true
        pidwait "$__browser" || true
        printf "%s exited.\n" "$__browser"
    fi
done

# Final verification (optional safety check)
__still_running=$(pgrep -x -l -f "$(echo $__browsers | tr ' ' '|')" || true)

if [ -z "$__still_running" ]; then
    printf "All browsers have been terminated successfully.\n"
    exit 0
else
    printf "Warning: Some browsers are still running:\n%s\n" "$__still_running"
    exit 1
fi
